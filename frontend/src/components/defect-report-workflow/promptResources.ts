import type { ConversationMessage } from './types';

export const DEFECT_JUDGEMENT_CRITERIA = `이미지와 결함 내용, 결함 판단 기준, 출력 예시를 참고하여 결함 리포트 행을 작성하세요.

[출력 형식 지침]
- 결함정도는 위험도에 따라 H(High) / M(Medium) / L(Low) 코드 중 하나로만 작성합니다.
- 발생빈도는 항상 발생(A) 또는 가끔 발생(R) 중 하나의 코드로만 작성합니다.

[결함 판단 기준]
1. 기능 적합성 : 주요 기능이 잘 동작하는지
    1. 기능 완전성 : 매뉴얼에 기술된 모든 기능이 구현되어 있는지 
        - 매뉴얼에 없는 기능을 PL과 의논 후, 기능이 제공된다고 수정하면 사용성으로 변경
            1. AAA 기능 미제공 - H: 매뉴얼에는 ‘AAA’ 기능이 제공된다고 기술되어 있지만, 실제 프로그램에서는 ‘AAA’ 기능이 제공되지 않음
    2. 기능 정확성 : 사용자가 입력 할 수 있는 유효한 입력, 범위 외의 기능 제공
        - 주요기능, 비정상 종료(신뢰성) H / 부가기능, 시험 범위 외의 불필요 기능 M
        - 캡쳐 화면 및 동영상 기록 후 첨부
        - 주요 기능이 정상적으로 동작하지 않거나 주요 목적과 다르게 동작하는지 확인
            1. AAA 기능 오류 - H: ~할시, ~되어야 하지만, ~됨
            2. 데이터 분석 기능 오류 - H: ‘데이터 분석’ 기능이 동작하지 않음
            3. 사용자 조회 기능 오류 - H: ‘시용자 조회’ 버튼 클릭 시 오류 메시지가 포함된 웹 페이지(’404 에러’)가 출력되고 기능이 실행되지 않음
        - 주요 기능이 정상적으로 동작하지 않거나 주요 목적과 다르게 동작하는지 확인
            1. SMS API 기능 오류 - H: [SMS API] 가상 사용자 100명이 동시에 SMS API를 호출하여 SMS로 OTP 전송 기능 실행 시, 100건의 SMS가 발신되어야 하지만 약 96건의 SMS가 잘못 발신됨
            2. 보안 메일 예약 발송 기능 오류 - H: 보안 메일을 예약 메일로 발송한 경우, 보안 메일로 발송되지 않음
            3. 배포 기능 오류 - H: [기타정보 설정>배포 마법사] 배포 마법사 기능이 동작하지 않음 <시험절차> 1. 배포할 파일을 선택한 후 ‘다음’버튼을 클릭함 2. 배포된 파일을 받을 사용자를 선택한 후 ‘다음’버튼을 클릭함 3. ‘전송’버튼 클릭 시 파일 전송 중 오류가 발생함
            4. 번호판 인식 기능 오류 - H : 특정 번호판(화물차, 오토바이) 인식 기능이 동작하지 않음
            5. SYN Flooding 공격 탐지 오류 - H : SYN Flooding 공격 시, 해당 공격이 탐지되지 않음
        - 주요 기능을 통해 조회된 데이터가 정확하게 출력되는지 확인
            1. 인사정보 조회 기능 오류 - H: [인사정보 조회] 개인별 인사정보 조회 결과(3건)와 직원별 전체 인사정보 조회 시 표시되는 개인별 인사정보 조회 결과(5건)가 상이함
            2. MY API 기능 오류 - H: [MY API] MY API 호출 시, ‘BBB’라는 값이 반환 되어야 하지만 ‘CCC’라는 값으로 잘못 반환됨
        - 부가 기능이 정상적으로 동작하지 않는지 확인
            1. 로그 조회 오류 - M: 특정 검색 조건(이벤트명)에서의 이벤트 로그 조회 기능이 동작하지 않음
            2. 메일 선택 삭제 기능 오류 - M: [관리자>보안 정책>메일 관리] 메일 목록에서 다수의 메일을 선택하고 ‘선택 삭제’ 버튼 클릭 시, 1개의 메일만 잘못 삭제됨
        - 시험 대상 범위의 외의 기능이 불필요하게 제공되는지 확인
            1. 불필요한 기능 제공 - M: 제품 범위에 해당하지 않은 기능(’AI 분석’)이 불필요하게 제공됨 
            
    3. 기능 적절성 : 기능을 적절하게 제공하는지
        - CRUD 기능에서 ‘생성/추가/등록/만들기’ 등의 기능이 제공되는 경우, 추가된 객체를 조회/변경/삭제하는 기능이 제공되는지 확인
            1. 게시글 변경 기능 미제공 : 공지사항 게시판에 게시글 변경 기능을 제공하지 않아, 해당 게시글을 수정하기 위해서는 게시글을 삭제하고 다시 생성해야함
            2. 파일 첨부 기능 미제공 : 이메일로 파일을 전송하기 위해 ‘파일 첨부’ 기능이 제공되어야 하지만 해당 기능이 누락됨

2. 성능 효율성 - H결함
    1. 시간반응성 : 느린지 확인
        - 주요 기능 및 부가 기능의 응답시간이 지연되는지 확인
        - 일반 기능(조회, 등록 등) 시에 3초 이내 (컴퓨웨어 40% 고객을 지킴)
        1. 응답시간 지연 - H: ~기능 실행 시, ~할 때까지의 소요시간이 약 60초로 길게 소요됨
    2. 자원효율성 : CPU, 메모리 사용량이 효율적인지
        - 주어진 기간 동안 주요 기능의 자원 효율성을 측정하여 시스템 자원을 효율적으로 사용하는지 확인
        - 모니터링, 관제는 4시간 측정, 그 외 10~60분 측정
        - 이용X인데 CPU 사용률 80% 이상
        - 메모리 반환 오류 (메모리 자원 소모 후, 정상적으로 반환X)
        - JAVA, C, C++ 등 JVM에 의해 메모리가 관리되어 OS메모리를 사용하지 않는지
        1. 과도한 CPU 사용 - H: 프로그램 구동 후 일정 시간(약 2시간)이 지나면 CPU 사용률이 99%까지 올라가고 정상 상태로 복귀되지 않음
        2. 메모리 반환 오류 - H: 성능(아발란체)를 이용하여 시험대상 제품으로 다량(200Mops)의 TCP 패킷 전송 시, 시험대상제품의 메모리 사용량이 평균 500MB 이상 증가하였지만 부하 감소 후 메모리(500MB)가 반환되지 않음
        3. 비정상적 스토리지 사용 - H: OLAP 성능 시험용 데이터(10GB) 삽입 후 TPC DS-Q10번 쿼리문 실행 시, 삽입된 데이터 스토리지 용량 보다 100배 이상의 추가 스토리지 용량(1,000GB)이 비정상적으로 요구됨
    3. 용량성 : 부하 발생 시에 운영에 영향이 있는지
        - 다수 사용자가 접속하는 경우에도 현저하게 응답시간이 지연되지 않는지 확인
        - 다수 사용자 접속 제품 : DBMS, 웹서버, 웹메일, 검색엔진, 서비스형 소프트웨어, 대용량 트래픽 예상 보안 SW(UTM, IPS, IDS, 웹방화벽 등), 기타 100명 이상의 사용자가 동시 접속하여 사용할 것으로 예상되는 제품
        - 다수 사용자 접속 제품일 경우, 성능 시나리오 작성하여 수행
        - 1 OR 100명일때 확인 1초간격으로 100TPS
        1. 응답시간 지연 - H: 100명의 사용자가 동시에 1초 간격으로 10분동안 검색 기능 실행 시, 평균 소요시간 약 20초 이상으로 길게 소요됨
3. 호환성
- 타 소프트웨어(예: 오피스 프로그램)를 설치하여 충돌하지 않는지 확인
    1. 공존성 :  타 소프트웨어와 영향을 끼치지 않는지 - 문서프로그램 
        
        1.   공존성 오류 - H: 프로그램이 오피스 프로그램과 충돌하여 실행되지 않음
        
- 타 소프트웨어와 연동하여 수행하는 기능이 정상적으로 동작하는지 확인
    1. 상호운용성 : 타 소프트웨어와 연동할 때, 정상 동작 하는지
        
        2.   날씨 정보 표시 기능 오류 - M: 기상청 API를 연동하여 날씨 정보가 대시보드에 표시되어야 하지만 표시되지 않음
        
4. 사용성
    1. 적절 인식성 
        - 제품설명서 및 사용자취급설명서에 제품의 주요 사용 목적이 기술되어 있는지 확인
        1. 주요 사용 목적 미제공 -M: [매뉴얼] 제품의 주요 사용 목적이 매뉴얼에 제공되지 않음
    2. 학습성 <> 기능적합성
        - 프로그램에서 제공하는 기능에 대한 설명이 매뉴얼에 기술되어 있는지 확인 → 기능 정보 미제공
        - 오류 메세지를 제공하지만, 불분명하거나, 문제의 원인을 파악하기 어려운 메시지인지 확인 → 잘못된 메시지 제공
        1. 기능 정보 미제공 -M: 프로그램에서는 AAA 기능이 제공되지만, 매뉴얼에서는 해당 기능에 대한 설명이 기술되어 있지 않음
        2. 잘못된 오류 메시지 제공 -M: ~를 실행 시, ‘내용을 수정할 수 없다’라는 잘못된 안내 메시지를 출력함
    3. 운영성
        - 프로그램에서 사용하는 메뉴명, 기능명 등의 단어 및 용어가 일관성 있게 사용되는지 확인
        1. 비일관적인 기능명 사용 -M: ‘문서미리보기’의 ‘개발형태’가 [조회>샘플]에서 ‘팀 업무구분’으로, [관리자>기타정보설정>부서별업무코드 등록]에서는 ‘업무구분’으로 기능명이 다르게 표시됨
        2. 비일관적인 API 사용 -M: API명이 getDATA, set_data 등과 같이 비일관적인 규칙으로 명명됨
        - 기능 맞춤화(커스터마이징) 또는 인터페이스 맞춤화 기능이 제공되는 경우, 해당 기능이 정상 동작하는지 확인 → 인터페이스 조정 오류
        1. 인터페이스 조정 오류 -M: [관리자 페이지 > 대시보드] 대시보드 위젯 추가 시, 추가된 위젯의 일부 글자가 잘려서 표시됨
        - 사용자취급설명서(매뉴얼)에 기술된 지원하는 입력 장치가 실제 프로그램에서도 지원되는지 확인 → 입력 장치 (IP 카메라) 미제공
        1. 입력 장치(IP 카메라 미제공) -M: 매뉴얼에는 IP 카메라와 연동하여, 실시간 영상 조회를 하는 것으로 기술되어 있지만, 실제 프로그램에서는 IP 카메라와 연동이 불가능함
        - 시간이 소요되는 기능의 경우, 기능의 실행 상태 정보를 사용자에게 제공하는지 확인 → 진행 상태 미표시 → 1분 이상 소요될 때
        1. 진행 상태 미표시 - M: [Console>Database명>테이블명>컬럼암호화] 진행 상태바가 제공되지 않아 암호화 진행 상태를 알 수 없음
        - 기능 실행 후 제공되는 안내 메시지가 기능 실행 목적과 동일하게 제공되는지 확인 → 잘못된 안내 메시지 제공
        1. 잘못된 안내 메시지 제공 - M: 
            - [사용자 관리] 사용자 등록 완료 시, 등록이 완료되었다는 안내 메시지가 제공되어야 하나 ‘수정되었습니다’라는 잘못된 안내 메시지가 제공됨
            - [사용자 관리] ‘사용자ID’ 입력필드에 값을 입력하지 않고 ‘중복체크’ 버튼 클릭 시, 값을 입력하라는 메시지가 제공되어야 하지만 ‘사용자ID 중복 체크를 수행하세요’라는 잘못된 안내 메시지가 제공됨
        - 입력필드 기본값 제공, 실행 취소 등의 편의 기능을 제공하는 경우, 해당 기능이 정상적으로 동작하는지 확인 → 필수 입력 항목 오류, 필수 입력 항목 미표시
        1. 필수 입력 항목 오류 - M: 사용자 이메일은 필수 입력 항목이지만, 사용자 이메일을 입력하지 않아도 사용자 등록이 가능함
        2. 필수 입력 항목 미표시 - M: 사용자 이메일은 필수 입력 항목이지만, 프로그램에 필수 입력 항목 표시가 제공되지 않음
        
    4. 사용자 오류 방지성
        - 삭제 기능을 제공하는 경우, 사용자의 확인을 요청하는 기능이 제공되는지 확인 → 오조작 방지 미제공
        1. 오조작 방지 미제공 - M : ‘전체 삭제’ 기능 실행 시, 오조작 방지를 위한 메시지가 제공되지 않음
    5. 접근성
        - 다국어를 지원하는 경우, 다국어 변경 시 변경된 언어로 기능명, 메뉴명, 메시지 등이 제공되는 확인
        1. 다국어 지원 오류 - M: 프로그램 언어를 영어로 변경하였지만, 일부 메뉴가 한글로 표시됨
5. 신뢰성
    1. 가용성 : 언제나 소프트웨어를 운영 및 접근 가능한지
        - GS 평가기간 내 일정기간 동안 소프트웨어 실행 불가 또는 운영 중단 없이 가용성을 보장하는지 확인 → 프로그램 비정상 중지, 프로그램 비정상 종료
        - 테스트 시나리오 불필요
        1. 프로그램 비정상 중지 - H: 청소 예약을 삭제하는 경우, 프로그램이 비정상 중지되고, 해당 스케줄이 삭제되지 않음
        2. 프로그램 비정상 종료 - H: 유효하지 않는 QR 코드 스캔 시, 앱이 비정상 종료됨
    2. 결함허용성
        - 고신뢰가 요구되는 소프트웨어의 경우, 고장을 회피하기 위한 기능이 정상 동작하는지 확인
        1. Fail-over 기능 오류 - H: 이중화 기능이 활성화 된 상황에서, Active 서버 비정상 종료 시, Standby 서버로 Fail-over 되지 않음
    3. 복구성
        - 자체 복구 기능을 지원하는 경우, 데이터 복구 기능이 정상 동작하는지 확인 → 데이터 복구 오류
        - 소프트웨어가 운영 데이터 저장을 위한 리포지토리 DB를 가지고 있는 경우, 리포지토리 DB 백업 및 복구 방법에 대한 안내가 매뉴얼에 제공되는지 확인 → 리포지토리 DB 백업 및 복구 방법 미제공
        - DBMS를 사용하지 않아도 복구/백업 기능이 매뉴얼에 제공되어야 함
        1. 데이터 복구 오류 - H: [dump] 30억건 데이터 삽입 후 ‘dump’ 프로그램을 실행하여 데이터 복구 시도 시, 데이터 30억건이 복구되어야 하지만, 10억건으로 잘못 복구됨
        2. 리포지토리 DB 백업 및 복구 방법 미제공 - M: 리포지토리 DB 백업 및 복구 방법이 매뉴얼에 제공되지 않음
6. 보안성
    - H 결함 : 중요정보 유출, 파일 무결성 훼손, 서비스 중단
    - M 결함 : 내부 로직 노출 등 그 외
    - 보안제품의 기능 결함은 기능적합성, 보안제품 자체를 보호하는 기능 결함은 보안성
    - 소스코드 기반의 보안 약점을 진단한 것은 아님, 평가 항목에 따라 평가
    
    1. 기밀성 : Invicti에 리포팅 (치명적, 높은, 중간)
        
        
        1. 사용자 계정정보 접근통제 오류 - H: 아이디/비밀번호가 txt 파일로 저장되어, 비인가자가 해당 파일 열람을 통해 비밀 번호 확인이 가능함
        2. 비밀번호 입력값 표시 오류 - H: 사용자 계정에 대한 비밀번호 변경 시, 비밀번호가 특수문자(*)로 표시되지 않고 평문(예:abc123)으로 표시됨
        3. 로그인 오류 - H: 잘못된 비밀번호를 입력하여도 로그인이 가능함
        4. 로그인 오류 - H: 유효한 관리자 계정 정보로 로그인하였지만, 화면이 로그인 진행 중 상태로 표시되고 로그인되지 않음
        5. 접근통제 오류 - H: 로그인 하지 않은 상태이지만, 웹 브라우저 주소창에 관리자 접속 URL 주소를 직접 입력하여 접속할 경우 비인가자의 관리자 페이지 접근이 가능함
        6. 보안설정 오류- H : ‘아래 IP에서만 접근 가능’ 라디오 버튼을 클릭하여, IP주소를 입력하고 저장할 경우, 해당 IP 주소에서만 웹페이지 접속이 가능하여야 하지만 접속이 불가능하고, 오히려 허용되지 않은 IP 주소에서 웹페이지 접속이 가능함
        7. 로그아웃 기능 오류 - H: 로그아웃 기능이 정상 동작하지 않아, 프로그램이 로그인 상태로 항시 유지되고 있음
        8. 세션타임아웃 기능 오류 - M: ‘세션 타임 아웃’ 기능이 설정된 시간 이후에도 동작하지 않음
        9. 권한별 기능 제공 오류 - H: 최고 관리자 권한이 아닌 모니터링 관리자 권한으로 로그인할 경우 ‘정책 설정’ 기능이 제공되지 않아야 하지만 그렇지 않음
        10. 관리자 동시 접속 오류 - M: 관리자 웹페이지에 접속할 수 있는 관리자는 1명이지만 2명이 동시에 로그인이 가능함
        11. 암호화되지 않은 개인정보 저장 - H: 
            - 사용자 접근 허용/차단 로그에서 사용자의 개인정보(예: 주민등록번호)가 저장됨
            - 사용자 개인정보(예: 주민등록번호)가 데이터베이스에 암호화되지 않고 평문으로 저장됨
        12. 암호화되지 않은 비밀번호 전송 - H: [로그인] 웹 브라우저에서 입력된 비밀번호가 암호화되지 않고 평문(예:abc)으로 전송되어 네트워크 패킷 분석도구(와이어샤크 등)을 통해 비밀번호 조회가 가능함
        13. 암호화되지 않은 비밀번호 저장 - H: [로그인] 사용자 비밀번호가 데이터베이스에 암호화되지 않고 평문으로 저장됨. 국내 암호화 가이드라인에 따라 단방향 알고리즘(SHA-256, 512 등) 적용을 권장함
        14. 취약한 암호화 알고리즘 사용 - H: 사용자 비밀번호가 보안에 취약한 암호화 알고리즘(MD5)을 사용하여 저장됨
        15. 비밀번호 솔트 값(salt) 기능 미제공 - M: [프로그램] 솔트 값(랜덤 데이터)없이 비밀번호가 단방향 암호화되어, 비밀번호 평문 추적이 가능함
        16. 잘못된 비밀번호 암호화 -M: 사용자 비밀번호는 안전한 해쉬알고리즘(예: SHA-256)으로 암호화해야 하지만, 대칭키 알고리즘(AES-256)으로 잘못 암호화됨
        17. SQL 입력 처리 오류 - H: 비밀번호 입력필드에 SQL문(예: ‘OR ‘1’=’1’) 입력 시, 권한이 없는 사용자 ID로 로그인이 가능함
        18. 크로스 사이트 스크립트 실행 오류 - H: [웹 페이지]
        게시글 작성 시, 제목에 크로스 사이트 스크립트(XSS)를 입력하여 게시글 조회 시, 사용자 PC에서 해당 스크립트가 실행됨
        예) <script>alert(’XSS’)</script>
        19. 실행파일 업로드 방지 오류 - H: 게시판에 실행 가능한 스크립트 파일(예: asp, jsp, php 등) 업로드가 가능함
        20. 중요정보 평문 전송 - H: 웹 브라우저에서 입력된 비밀번호가 암호화 되지 않은 프로토콜(HTTP)을 통해 평문(예:abc)으로 서버 전송되어 네트워크 패킷분석도구(와이어샤크 등)를 통해 비밀번호 조회가 가능함
        21. 내부로직정보 표시 - M: 응답 헤더 및 오류 페이지(403 Forbidden)에 내부 시스템 정보를 파악할 수 있는(’nginx 1.18.0’) 메시지가 출력됨
        22. 구 버전의 Apache HTTP Server 사용 - M: 최신 버전의 Apache HTTP Server를 사용하고 있지 않음
    - 현재 버전 :
    - 최신 버전 :
    1. 무결성
        - 업데이트 파일 무결성 검사 기능 미제공 - H: 업데이트 서버로 부터 설정파일, 보안정책, 악성코드 탐지규칙 파일 등 다운로드 시, 파일의 무결성 검사를 수행하지 않음
        1. 데이터 백업/복구 방법 미제공 - M: 비인가자의 데이터 파손 및 변경 방지를 위한 데이터 백업 및 복구 방법이 매뉴얼에 제공되지 않음
    2. 부인방지성
        1. 전자서명 기능 미제공 - M: [결재] 결재 부인방지를 위한 전자서명 기능이 제공되지 않음
    3. 책임성
        1. 사용자 감사 추적 오류 - M: 시험대상 제품에서 사용자 로그인 등 중요 이벤트가 감사로그에 기록되지 않음
        2. 사용자 감사로그 백업 방법 미제공 - M: 사용자 감사로그 백업 방법이 매뉴얼에 제공되지 않음
    4. 인증성
        1. 생체인증 미제공 - M: 매뉴얼에서는 생체인증 및 ID/Password 인증이 제공된다고 기술되어 있지만, 실제 프로그램에서는 로그인 인증만 제공되어 매뉴얼과 프로그램이 불일치함
        2. 비밀번호 설정 기능 오류 - M: [로그인]3자리 길이의 짧은 문자열로 비밀번호(예:123) 설정이 가능함 *국내 비밀번호 작성 가이드라인에 따라, 문자, 숫자, 특수문자 등의 조합으로 8자리 이상의 비밀번호 사용을 권장함
        3. 비밀번호 확인 기능 오류 - M: [비밀번호 변경] 관리자 계정에 대한 패스워드 변경 시, ‘비밀번호’ 입력필드와 ‘비밀번호 확인’ 입력필드에 서로 다른 값을 입력하였지만, 비밀번호 변경이 가능함
        4. 비밀번호 확인 기능 미제공 - M: 비밀번호 변경 시, 기존 비밀번호 확인 과정 없이 비밀번호 변경이 가능함
        5. 반복된 인증시도 제한 기능 미제공 - M: [로그인] 잘못된 비밀번호를 입력하여 로그인 시도를 5회 이상 반복하였지만 로그인 계정이 잠기지 않음
        6. 반복된 인증시도 제한 기능 미제공 - M: [로그인]
        잘못된 비밀번호를 입력하여 로그인 시도를 5회 이상 반복하였지만 로그인 계정이 잠기지 않음
        7. 반복된 로그인 시도 제한 기능 오류 - M: [로그인]
        잘못된 비밀번호를 입력하여 로그인 시도를 5회 이상 반복 시 로그인 계정이 잠겼지만, 프로그램 재실행 후 로그인 시도가 가능함
        8. 관리자 기본 비밀번호 변경 기능 미제공 - M: 제품 설치 시 관리자 기본 비밀번호를 제공하는 제품으로, 비밀번호 보안을 위해 비밀번호(예:1234) 변경을 요구하지 않음
        9. 개인정보 수정 시 재인증 절차 부재 - M: [환경설정 > 내 정보 관리] 재인증 절차 없이 개인정보 수정(비밀번호, 휴대폰 번호 등)이 가능함

7. 유지보수성
    1. 분석성
        - 소프트웨어 고장 발생 시, 고장 원인을 분석할 수 있는 별도의 시스템 로그를 제공하는지 확인 → 문제 진단 정보 미제공
        - 시스템 로그, 에러 로그, 네트워크 통신 로그, 덤프 파일
        1. 문제 진단 정보 미제공 - M: 제품 구동 중 문제 발생 시 문제 원인을 진단할 수 있는 정보(예: 로그)가 제공되지 않음
    2. 변경성
        - 소프트웨어 환경설정 변경 시에도 주요 기능 동작에 영향이 없는지 확인 → 환경 설정 오류
        1. 환경 설정 오류 - M: DBMS의 포트 번호가 변경되어 프로그램의 DBMS 포트 번호를 변경한 후 DBMS 연결을 시도하면 오류 메시지가 출력되고 DBMS에 정상적으로 연결되지 않음
    3. 시험성
        - 자체 시험 기능을 제공하는 경우, 해당 시험 기능이 정상 동작하는지 확인 → 연결 테스트 기능 오류
        1. 연결 테스트 기능 오류 - M: DBMS의 연결 여부를 확인하는 ‘연결 테스트’ 기능이 동작하지 않음
8. 이식성 : 설치가 잘 되고 다양한 환경에 적응하는지
    1. 적응성
        - GS 시험 환경에서 소프트웨어가 정상 동작하는지 확인 → AAA 기능 오류 → OS
        1. AAA 기능 오류 - M: Window Os 환경에서는 ‘AAA’ 기능이 정상 동작하지만, Linux OS 환경에서 ‘AAA’ 기능이 동작하지 않음
    2. 설치성
        1. 설치 매뉴얼 미제공 - M: 프로그램 설치 매뉴얼이 제공되지 않음
        2. 설치 경로 설정 기능 미제공 - M: 프로그램 설치 시, 설치 경로 설정 기능이 제공되지 않음
    3. 대체성
        - 이전 버전에서의 기능을 현재 버전에서 사용할 수 없는지 확인 → 기능 포괄성 부족
        1. 기능 포괄성 부족 - M: 시험대상제품(v2.0)에서는 이전버전(v1.0)에서 제공하였던 ‘AAA’ 기능이 제공되지 않지만 이에 대한 설명이 매뉴얼에 제공되지 않음


9. 일반적 요구사항 : 오타 L
    1. 품질특성별 정보제공
        - 제품설명서 또는 사용자취급설명서에 주요 품질 특성별 정보를 제공하는지 확인
            1. 제품설명서/사용자 취급 설명서 미제공 - H: 제품설명서(브로슈어)가  제공되지 않음
            2. 기능적합성 정보 미제공 - M : ‘’에 대한 기능 정보가 매뉴얼에 제공되지 않음
            3. 성능효율성 정보 미제공 - M : 제품 구동을 위해 필요한 최소 혹은 권장 장비 사양 정보가 매뉴얼에 제공되지 않음
            4. 호환성 정보 미제공 - M : 시험대상제품은 타 제품과 연동되지만 연동제품 정보가 매뉴얼에 제공되지 않음
            5. 사용성 정보 미제공 - M : 보편적으로 사용되지 않는 용어 및 약어에 대한 정보가 매뉴얼에 제공되지 않음
            6. 신뢰성 정보 미제공 - M : 데이터 백업 및 복구 절차에 대한 정보가 매뉴얼에 제공되지 않음
            7. 보안성 정보 미제공 - M : 프로그램 사용 권한에 따른 접근 제어 정보가 매뉴얼에 제공되지 않음
            8. 유지보수성 정보 미제공 - M : 프로그램 운영 로그가 저장되는 위치 정보가 매뉴얼에 제공되지 않음
            9. 이식성 정보 미제공 - M : 제품 설치 방법 및 절차에 대한 정보가 매뉴얼에 제공되지 않음
    2. 제품설명서/사용자취급설명서 요구사항
        - 제품을 식별하기 위해 소프트웨어 명칭, 버전, 용도 등의 정보를 제공하는지 확인
            1. 제품 식별 정보 미제공 - M : 시험 제품은 ‘AAA v1.0’이나 프로그램과 매뉴얼에 버전이 명시되어 있지 않음
            2. 제품 용도 정보 미제공 - M : 제품을 이용하여 수행할 수 있는 업무에 대한 정보가 제공되지 않음
            3. 제품 공급자 정보 미제공 - M : 제품의 공급자 정보(예: 회사 이름, 주소, 전화번호 등)가 매뉴얼에 제공되지 않음
            4. 제품 지원 정보 미제공 - M : 제품 운영을 위한 지원 정보(예: 고객지원 센터 연락처)가 매뉴얼에 제공되지 않음
`;

export const DEFECT_OUTPUT_EXAMPLE = `기업 선택 기능 오류\tM\tA\t기능적합성\t"[그룹 관리]
기업명이 동일한 기업(기업코드는 다름)이 2개 이상 존재할 경우, 그룹 생성 시 기업 선택 드롭다운 목록에서 선택한 기업(기업코드: TEST3)이 아닌 동명의 다른 기업(기업코드: CP001)이 잘못 선택됨"
잘못된 식별 정보 제공\tM\tA\t일반적 요구사항\t"[시험대상 프로그램]
[사용자 매뉴얼]
프로그램과 사용자 매뉴얼에 제품 식별 정보(예: 제품명, 버전)가 잘못 표시됨

<TTA 의견>
제품 식별 정보는 시험합의서의 계약명과 동일하게 해주셔야 합니다.

 - 계약명 : SafetyGuard Vision Pro V1.0"`;

export interface PromptResourcesConfig {
  judgementCriteria: string;
  outputExample: string;
}

export interface PromptResourcesPayload {
  judgementCriteria: string;
  outputExample: string;
  conversation: ConversationMessage[];
}

export function buildPromptResourcesPayload(
  messages: ConversationMessage[],
  overrides?: Partial<PromptResourcesConfig>,
): PromptResourcesPayload {
  const judgement = overrides?.judgementCriteria ?? DEFECT_JUDGEMENT_CRITERIA;
  const example = overrides?.outputExample ?? DEFECT_OUTPUT_EXAMPLE;

  return {
    judgementCriteria: judgement,
    outputExample: example,
    conversation: messages.map((message) => ({
      role: message.role,
      text: message.text,
    })),
  };
}
